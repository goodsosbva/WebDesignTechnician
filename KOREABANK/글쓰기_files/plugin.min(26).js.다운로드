!function(t){var n={};function e(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,e),i.l=!0,i.exports}e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:r})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(e.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var i in t)e.d(r,i,function(n){return t[n]}.bind(null,i));return r},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},e.p="/",e(e.s=538)}({165:function(t,n,e){"use strict";e.d(n,"a",(function(){return r}));var r=function(t){return window.tinymce.settings.plugins.includes(t)}},538:function(t,n,e){"use strict";function r(t){return t.replace(/-/g,".")}function i(t){var n=new Date(t);return isNaN(n.getDate())?"":n.toLocaleDateString("ko-kr",{weekday:"short"})}e.r(n);var o,a=function(){function t(){}return t.prototype.getPropertyString=function(t,n){return Array.isArray(n)&&(n=n.join(", ")),null!=n&&0!==n.length||(n="-"),"<dl class='cs-info'>\n      <dt>"+t+"</dt>\n      <dd>"+n+"</dd>\n    </dl>"},t.prototype.isType=function(t){return t===this.kind},t}(),s=(o=function(t,n){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])},o(t,n)},function(t,n){function e(){this.constructor=t}o(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),c=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.kind="book",n}return s(n,t),n.prototype.getHTMLString=function(t){return"\n        <div class='cs-desc'>"+(t.desc||"-")+"</div>\n        <div class='cs-props'>\n        "+this.getPropertyString("저자",t.authors)+"\n        "+this.getPropertyString("출판",t.publisher)+"\n        "+this.getPropertyString("출판일",r(t.publicationDate))+"\n        </div>\n      "},n}(a),u=new c,p=function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])},t(n,e)};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),d=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.kind="person",n}return p(n,t),n.prototype.getHTMLString=function(t){var n=t.websites&&"\n      <object>\n        "+t.websites.slice(0,3).map((function(t){return'<a href="'+t.url+'">'+t.title+"</a>"})).join(", ")+"\n      </object>  \n      ";return"\n        <div class='cs-props'>\n        "+this.getPropertyString("직업",t.jobTitles)+"\n        "+this.getPropertyString("소속",t.memberOf)+"\n        "+this.getPropertyString("사이트",n)+"\n        </div>\n    "},n}(a),l=new d;function f(t,n,e){return void 0===e&&(e=1),(t/n).toFixed(e)}var g=function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])},t(n,e)};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),h=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.kind="movie",n}return g(n,t),n.prototype.getHTMLString=function(t){var n=null!=t.rating?'<span class="ico-star"></span>'+f(t.rating,10)+" "+(t.releaseDate&&"("+r(t.releaseDate)+" 개봉)"):"-";return"\n      <div class='cs-desc'>"+(t.desc||"-")+"</div>\n      <div class='cs-props'>\n        "+this.getPropertyString("평점",n)+"\n        "+this.getPropertyString("감독",t.directors)+"\n        "+this.getPropertyString("출연",t.actors)+"\n      </div>"},n}(a),y=new h,v=function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])},t(n,e)};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),_=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.kind="tv",n}return v(n,t),n.prototype.getHTMLString=function(t){return"<div class='cs-desc'>"+(t.desc||"")+"</div>\n          <div class='cs-props'>\n          "+this.getPropertyString("시간",this.makeScheduleString(t))+"\n          "+this.getPropertyString("출연",t.actors.join(", "))+"\n          "+this.getPropertyString("채널",t.channel)+"\n          </div>\n      </div>"},n.prototype.makeScheduleString=function(t){var n,e;return[(n=t.broadcastDayOfWeek,null!=n?n:[]).join(", "),t.broadcastTime?(e=t.broadcastTime,new Date("0 "+e).toLocaleTimeString("ko-kr",{hour12:!0,hour:"numeric",minute:"2-digit"})):"",t.startDate?"("+t.startDate+"~"+(t.endDate||"")+")":""].filter((function(t){return t})).join(" ")},n}(a),m=new _,S=function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])},t(n,e)};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),b=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.kind="play",n}return S(n,t),n.prototype.getHTMLString=function(t){var n=null!=t.rating?'<span class="ico-star"></span>'+f(t.rating,10):"-",e=t.startDate?r(t.startDate)+"("+i(t.startDate)+")~":"",o=t.endDate?r(t.endDate)+"("+i(t.endDate)+")":"";return"\n      <div class='cs-desc'>"+(t.desc||"")+"</div>\n        <div class='cs-props'>\n          "+this.getPropertyString("평점",n)+"\n          "+this.getPropertyString("기간",e+o)+"\n          "+this.getPropertyString("장소",t.location)+"\n          "+this.getPropertyString("출연",t.actors)+"\n        </div>\n      </div>"},n}(a),T=new b,C=function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])},t(n,e)};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),P=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.kind="music",n}return C(n,t),n.prototype.getHTMLString=function(t){return"\n          <div class='cs-props'>\n          "+this.getPropertyString("아티스트",t.artist)+"\n          "+this.getPropertyString("앨범",t.albumTitle)+"\n          "+this.getPropertyString("발매일",r(t.releaseDate))+"\n          </div>\n      "},n}(a),O=new P,w=function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])},t(n,e)};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),k=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.kind="exhibition",n.EXHIBITION_GENRE="전시/행사",n}return w(n,t),n.prototype.getHTMLString=function(t){var n=t.startDate?r(t.startDate)+"("+i(t.startDate)+")~":"",e=t.endDate?r(t.endDate)+"("+i(t.endDate)+")":"";return"\n      <div class='cs-props'>\n        "+this.getPropertyString("장르",this.EXHIBITION_GENRE)+"\n        "+this.getPropertyString("기간",n+e)+"\n        "+this.getPropertyString("장소",t.location)+"\n      </div>"},n}(a),D=new k,L=function(){function t(t){this.CDMTypeName="contentSearch",this.parserCommandPrefix="GetHTMLByCDM_",this.insertCommandPrefix="InsertHTMLByCDM_",this.parserCommand=this.parserCommandPrefix+this.CDMTypeName,this.insertCommand=this.insertCommandPrefix+this.CDMTypeName,this.editor=t}return t.prototype.register=function(){var t=this;this.editor.addCommand(this.parserCommand,(function(n){var e=n.htmlArray,r=n.item,i=t.getHTMLStringByCDM(r.attribute);e.push(i)})),this.editor.addCommand(this.insertCommand,(function(n){var e=t.getHTMLStringByCDM(n.attribute);t.editor.insertContent(e),function(t,n,e,r){void 0===e&&(e=!0),void 0===r&&(r=!0);var i=t.contentWindow,o=i.scrollY,a=i.innerHeight;if(t.settings.scroll_container_id){var s=(i=document.getElementById(t.settings.scroll_container_id)).getBoundingClientRect(),c=s.top,u=s.height;o=i.scrollTop||i.pageYOffset,a=u-c}var p=n.offsetTop,d=n.offsetHeight;e&&p+d>a+o?i.scrollTo(0,p+d-a):r&&p<o&&i.scrollTo(0,p)}(t.editor,t.editor.selection.getNode())}))},t.prototype.getHTMLStringByCDM=function(t){var n='\n    <figure contenteditable="false" \n    data-ke-type="'+this.CDMTypeName+'" \n    data-ke-align="'+t.align+'" \n    data-cs-kind="'+t.kind+'">\n      <a href="'+t.data.url+'" target="_blank">\n        <div class="cs-image" '+(t.data.image&&'style="background-image: url('+t.data.image+');"')+'></div>\n        <div class="cs-info-wrap">\n          <span class="cs-title">'+t.data.title+"</span>\n          "+this.getHTMLStringByContentType(t)+"\n        </div>\n      </a>\n    </figure>\n    ";return this.editor.dom.getOuterHTML(this.editor.$(n).attr("data-cs-data",JSON.stringify(t.data)))},t.prototype.getHTMLStringByContentType=function(t){switch(t.kind){case"book":return u.getHTMLString(t.data);case"person":return l.getHTMLString(t.data);case"movie":return y.getHTMLString(t.data);case"play":return T.getHTMLString(t.data);case"tv":return m.getHTMLString(t.data);case"music":return O.getHTMLString(t.data);case"exhibition":return D.getHTMLString(t.data);default:return this.notSupported(t)}},t.prototype.notSupported=function(t){return""},t}(),M=["alignCenter","alignLeft","alignRight"],x=function(){function t(t,n){this.editor=t,this.TARGET_NODE=n,this.postrender=this.postrender.bind(this)}return t.prototype.getTargetNode=function(){var t=this.editor.selection.getNode(),n=this.editor.$(t).closest(this.TARGET_NODE);return n&&n[0]&&n},t.prototype.setAlign=function(t){var n=this.getTargetNode();n&&n[0]&&n.attr("data-ke-align",t)},t.prototype.register=function(t,n){var e=M.find((function(t){return t===n}));if(e){this.editor.addCommand(t,this.setAlign.bind(this,e));var r={alignCenter:{title:"Align center",icon:"imagealigncenter"},alignLeft:{title:"Align left",icon:"imagealignleft"},alignRight:{title:"Align right",icon:"imagealignright"}};this.editor.addButton(t,{title:r[n].title,cmd:t,icon:r[n].icon,activestate:n,onpostrender:this.postrender})}},t.prototype.postrender=function(t){var n=this,e=t.control,r=function(){var t=n.getTargetNode();if(t&&t[0]){var r=t.attr("data-ke-align");e.active(e.settings.activestate==r)}};r(),this.editor.on("nodeChange",(function(t){r()}))},t}(),j=function(){for(var t=0,n=0,e=arguments.length;n<e;n++)t+=arguments[n].length;var r=Array(t),i=0;for(n=0;n<e;n++)for(var o=arguments[n],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r},H=function(){function t(t){this.editor=t,this.TARGET_SELECTOR='figure[data-ke-type="contentSearch"]',this.ALLOWED_ACTIONS=j(M),this.editor=t,this.actions=[new x(t,this.TARGET_SELECTOR)],this.contextToolbarPredicate=this.contextToolbarPredicate.bind(this)}return t.prototype.contextToolbarPredicate=function(t){return this.editor.dom.is(t,this.TARGET_SELECTOR)},t.prototype.register=function(){var t=this,n=this.editor.settings.kContentSearch&&this.editor.settings.kContentSearch.toolbar;if(n&&""!==n){var e=n.split(" ").reduce((function(n,e){if(t.ALLOWED_ACTIONS.includes(e)){var r="kContentSearch"+e;return t.actions.forEach((function(t){t.register(r,e)})),j(n,[r])}if("|"===e)return j(n,["|"])}),[]).join(" ");this.editor.addContextToolbar(this.contextToolbarPredicate,e)}},t}(),E=function(){function t(t,n){this.editor=t,this.url=n,this.kContentSearchsettings=t.settings.kContentSearch}return t.prototype.toggle=function(t){this.$container?(null==t&&(t=this.editor.dom.isHidden(this.$container)),t?this.$container.show():this.$container.hide()):this.addContainer()},t.prototype.addContainer=function(){var t=this.editor,n=t.$,e=t.dom.add(document.body,"iframe",{style:{overflow:"hidden",position:"fixed","z-index":99998,top:"14px",right:"14px",width:"310px",height:"calc(100vh - 28px)","background-color":"#fff","border-radius":"4px","box-shadow":"rgba(0, 0, 0, 0.6) 0px 0px 2px 0px, rgba(0, 0, 0, 0.08) 0px 2px 18px 0px",border:"none"},name:"kContentSearch",id:"kContentSearch",title:"kContentSearch",src:this.url});this.$container=n(e),this.addEvents()},t.prototype.addEvents=function(){var t=this;this.editor.on("SelectionChange",(function(){"BODY"!==t.editor.selection.getNode().nodeName&&(t.lastCursorLocation=t.editor.selection.getRng())})),window.addEventListener("message",(function(n){if(t.kContentSearchsettings.url.includes(n.origin)){var e=n.data;"close"===e.type&&e.payload?t.toggle(!1):"insertContent"===e.type&&(t.editor.selection.setRng(t.lastCursorLocation),t.editor.execCommand("InsertHTMLByCDM_"+e.payload.type,e.payload))}}))},t}(),A=e(165),N=function(t){var n=["music","video","movie","book","tv","play","exhibition","person"],e=t.settings&&t.settings.kContentSearch,r=e&&e.use_text_menu||!1,i=function(t){var r,i,o=new URL(t);return o.searchParams.append("service_type",e.service_type),o.searchParams.append("content_type",(r=e.content_type,i="string"==typeof r?r.split(","):n,Object(A.a)("video")||(i=i.filter((function(t){return"video"!==t}))),i.join(","))),o.href};new L(t).register(),new H(t).register();var o=new E(t,i(e.url));t.addButton("kContentSearch",{icon:"contentSearch"+(r?"-text":""),cmd:"kContentSearchToggleSidePanel",tooltip:"글감검색"}),t.addCommand("kContentSearchToggleSidePanel",(function(){o.toggle()})),t.on("init",(function(){var n=t.dom,r=n.add(document.body,"iframe",{style:{display:"none"},src:i(e.url)});r.onload=function(){n.remove(r)}}))};window.tinymce.PluginManager.add("kContentSearch",N)}});
